{% extends 'base.html' %} 
{% load static %}

{% block content %}

<div
  id="success-container"
  class="max-w-3xl mx-auto text-center relative z-10 flex flex-col items-center justify-center min-h-[400px] {% if not grupo.status_confirmacao %}hidden{% endif %}"
>
  <div data-aos="zoom-in" class="mb-6">
    <svg
      class="w-16 h-16 text-dark-green opacity-90"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
      ></path>
    </svg>
  </div>

  <h2
    data-aos="fade-down"
    class="text-3xl md:text-5xl text-dark-green font-serif-display mb-6"
  >
    Presença Confirmada
  </h2>
</div> 

<div 
  id="form-container"
  class="max-w-3xl mx-auto text-center relative z-10 {% if grupo.status_confirmacao %}hidden{% endif %}"
>
  <h2
    data-aos="fade-down"
    class="text-3xl md:text-5xl text-dark-green font-serif-display mb-2"
  >
    Confirme sua presença
  </h2>

  <h3
    data-aos="fade-up"
    class="text-xl md:text-2xl text-dark-green/80 font-quicksand mb-10"
  >
    {{ grupo.nome }}
  </h3>

  <form
    data-aos="zoom-in-up"
    id="rsvp-form"
    class="w-full max-w-lg mx-auto bg-wedding-cream/10 backdrop-blur-sm rounded-xl p-6 md:p-8 shadow-sm border border-dark-green/10"
  >
    {% csrf_token %}
    <input
      type="text"
      name="codigo_acesso"
      value="{{ grupo.codigo_acesso }}"
      style="display: none"
      tabindex="-1"
      autocomplete="off"
    />
    
    <div class="flex flex-col gap-6 mb-10">
      {% for convidado in convidados %}
      <div
        class="flex items-center justify-between border-b border-dark-green/20 pb-2 hover:bg-white/10 transition-colors px-2 rounded"
      >
        <label
          for="guest_{{ forloop.counter }}"
          class="text-lg md:text-xl text-dark-green font-quicksand text-left flex-1 cursor-pointer"
        >
          {{ convidado.nome }}
        </label>
        <div class="ml-4">
          <label
            class="cursor-pointer relative flex items-center justify-center w-8 h-8"
          >
          <input
              type="checkbox"
              id="guest_{{ forloop.counter }}"
              name="confirmacao" 
              value="{{ convidado.id }}"
              class="checkbox-circle peer sr-only"
              {% if convidado.status_confirmacao == 'confirmado' %}checked{% endif %}
            />
            <div
              class="w-6 h-6 rounded-full border-2 border-dark-green transition-all duration-200"
            ></div>
            <svg
              class="w-4 h-4 text-wedding-cream absolute opacity-0 peer-checked:opacity-100 transition-opacity pointer-events-none"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="3"
                d="M5 13l4 4L19 7"
              ></path>
            </svg>
          </label>
        </div>
      </div>
      {% endfor %}
    </div>
    <div class="text-center">
      <button
        type="submit"
        class="px-10 py-3 bg-light-brown text-dark-green font-bold font-quicksand rounded shadow-md hover:bg-dark-brown hover:text-white transition-all duration-300 uppercase tracking-widest text-sm md:text-base"
        >
        Confirmar
      </button>
    </div>
  </form>
</div>

<script src="{% static 'js/block_null_forms.js' %}"></script>
<script src="{% static 'js/post_invitation.js' %}"></script>

{% endblock content %}